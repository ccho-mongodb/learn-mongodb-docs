<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<meta name="keyword" content="">

    <link rel="shortcut icon" href="/node-mongodb-native/core/img/favicon.png">

    <title>Connection Settings</title>

    <link rel="stylesheet" href="/node-mongodb-native/core/lib/bootstrap.css" type="text/css" />
<link rel="stylesheet" href="/node-mongodb-native/core/lib/font-awesome/css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="/node-mongodb-native/core/css/mongodb-docs.css" type="text/css" />
<link rel="stylesheet" href="/node-mongodb-native/core/css/overrides.css" type="text/css" />
<link rel="stylesheet" href="/node-mongodb-native/core/lib/highlight/styles/idea.css" />
<link rel="stylesheet" href="/node-mongodb-native/core/lib/bootstrap-toggle/bootstrap-toggle.min.css" type="text/css" />
<link rel="stylesheet" href="/node-mongodb-native/core/css/java.css" type="text/css" />


  </head>

  <body>
  
  <section id="container" class="">
      
      <header id="header-db" class="row" role="navigation">
  <div class="header-content">
    <div class="toggle-nav pull-left">
        <i class="fa fa-bars"></i>
        <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"></div>
    </div>
    
    <div class="logo pull-left">
      <a href="/node-mongodb-native/core/../">
        <img src="/node-mongodb-native/core/img/logo-mongodb-header.png", alt="MongoDB.org" />
      </a>
    </div>
    
    <div>
<div class="nav-items pull-right">
  <a href="https://university.mongodb.com" data-toggle="tooltip" data-placement="bottom" title="Free Online Classes">MongoDB University</a>
  <a href="http://www.mongodb.org/downloads" data-toggle="tooltip" data-placement="bottom" title="Download MongoDB">Downloads</a>
  <a href="http://www.mongodb.org/get-involved" data-toggle="tooltip" data-placement="bottom" title="Get involved with MongoDB">Community</a>
  <a href="http://docs.mongodb.org" data-toggle="tooltip" data-placement="bottom" title="The MongoDB Documentation">Docs</a>
  <a href="http://blog.mongodb.org" data-toggle="tooltip" data-placement="bottom" title="The MongoDB Blog">Blog</a>
  <div id="search">
<form method="get" action="//www.google.com/search" target="_blank">
    <input type="text" name="searchQuery" size="20" value="" autocomplete="off" placeholder="Search docs">
    <input type="hidden" name="site" value="/node-mongodb-native/core">
    <input type="hidden" name="q" value="">
    <label for="searchQuery"><i class="fa fa-search fa-1"></i></label>
</form>
</div>

</div>
</div>

  </div>
</header>

      

      
<aside id="sidebar" class="sidebar">
    <div class="ssidebar nav-collapse">
      <div class="ssidebarwrapper">
        <h3>
          <a class="index-link" href="/node-mongodb-native/core/../">MongoDB Node.js Core Driver</a>
          <a class="version pull-right" href="/node-mongodb-native/core">3.0.0-rc0</a>
        </h3>

        
        <ul class="sidebar-menu">
          
          
          
          
          
          
          
          
          
          
          
          

          
          
            
            









  


          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
    
      
    
  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  
    
    
      
      
        
        
        
        
        
        
        
        









  
  
  
  
  
  
  
  

  
    
    
    
      
      
      
        
        
        
      
      
    
    
  
  


        
      
    
    
  


        
      
    
      
      
        
      
    
      
      
    
      
      
    
      
      
    
    
  


        
      
    
    
  


          
            
            









  


          
            
            









  


          
            
            









  


          
            
            









  


          

          

          
            
            
















    <li class="toctree-l1">
    <a href="/node-mongodb-native/core/whats-new/">
        <i class='fa fa-cog'></i>
        What&#39;s New
    </a>
  </li>

          
            
            













  




<li class="toctree-l1  current">
  <a href="/node-mongodb-native/core/driver/" class="">
      <i class='fa fa-arrows-h'></i>
      <span>MongoDB Core</span>
      <span class="menu-arrow fa fa-angle-down"></span>
  </a>
    <ul  class="current">
        
        
        
        
















<li class="toctree-l2 ">
  <a href="/node-mongodb-native/core/driver/getting-started/" class="">
      <i class='fa fa-road'></i>
      <span>Getting Started</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l3">
    <a href="/node-mongodb-native/core/driver/getting-started/installation-guide/">
        <i class='fa'></i>
        Installation Guide
    </a>
  </li>

        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/node-mongodb-native/core/driver/getting-started/quick-tour/">
        <i class='fa'></i>
        Quick Tour
    </a>
  </li>

        
        
    </ul>
  </li>

        
        
        
        
        













  




<li class="toctree-l2  current">
  <a href="/node-mongodb-native/core/driver/reference/" class="">
      <i class='fa fa-book'></i>
      <span>Reference</span>
      
  </a>
    <ul  class="current">
        
        
        
        













  




<li class="toctree-l3  current">
  <a href="/node-mongodb-native/core/driver/reference/connecting/" class="">
      <i class='fa'></i>
      <span>Connecting</span>
      
  </a>
    <ul  class="current">
        
        
        
        













  




    <li class="toctree-l4">
    <a href="/node-mongodb-native/core/driver/reference/connecting/connection-settings/">
        <i class='fa'></i>
        Connection Settings
    </a>
  </li>

        
        
    </ul>
  </li>

        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/node-mongodb-native/core/driver/reference/crud/">
        <i class='fa'></i>
        CRUD Operations
    </a>
  </li>

        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/node-mongodb-native/core/driver/reference/extending/">
        <i class='fa'></i>
        Extending Cursors
    </a>
  </li>

        
        
        
        
        
















    <li class="toctree-l3">
    <a href="/node-mongodb-native/core/driver/reference/pool/">
        <i class='fa'></i>
        Pool Design
    </a>
  </li>

        
        
        
        
        
















<li class="toctree-l3 ">
  <a href="/node-mongodb-native/core/driver/reference/management/" class="">
      <i class='fa'></i>
      <span>Management</span>
      
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l4">
    <a href="/node-mongodb-native/core/driver/reference/management/logging/">
        <i class='fa'></i>
        Logging
    </a>
  </li>

        
        
    </ul>
  </li>

        
        
    </ul>
  </li>

        
        
    </ul>
  </li>

          
            
            
















    <li class="toctree-l1">
    <a href="/node-mongodb-native/core/api">
        <i class='fa fa-file-text-o'></i>
        API Documentation
    </a>
  </li>

          
            
            
















    <li class="toctree-l1">
    <a href="https://github.com/mongodb-js/mongodb-core">
        <i class='fa fa-github'></i>
        Source Code
    </a>
  </li>

          
            
            
















    <li class="toctree-l1">
    <a href="/node-mongodb-native/core/issues-help/">
        <i class='fa fa-life-ring'></i>
        Issues &amp; Help
    </a>
  </li>

          
            
            
















    <li class="toctree-l1">
    <a href="https://gitter.im/mongodb/node-mongodb-native?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge">
        <img src='https://badges.gitter.im/Join Chat.svg'/>
        
    </a>
  </li>

          
        </ul>
        
    </div>
  </div>
  
</aside>

<div class="option-popup closed hidden" id="optionsVersionsPopup">
<div class="option-header">
  <i class="fa fa-gear"></i>
  <span>OPTIONS</span>
  <i class="fa fa-angle-up pull-right"></i>
</div>
<div class="option-body">
  <ul>
      
      <li>
        <label>Version</label>
        <div class="btn-group btn-group-xs pull-right">
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            Select Version <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu" id="optionsVersionsMenu">
          </ul>
        </div>
      </li>

   


    

  </ul>
</div>
</div>



      
      <section id="main-content" class="content">
          <section class="main-column pull-left">
            <div class="document">
              <div class="documentwrapper">
                <div class="bodywrapper">
                  <div class="body">


   
<a class="edit-link" href="https://github.com/mongodb/mongo-nodejs-driver/blob/master/docs/reference/content/driver/reference/connecting/connection-settings.md" target="_blank" title="Edit driver/reference/connecting/connection-settings.md on GitHub"><i class="fa fa-pencil-square-o"></i></a>










<div class="bc">
<ul>
  
  
  
  <li><a href="/node-mongodb-native/core/driver/">MongoDB Core</a> <i class="fa fa-angle-right"></i></li>
  <li><a href="/node-mongodb-native/core/driver/reference/">Reference</a> <i class="fa fa-angle-right"></i></li>
  <li><a href="/node-mongodb-native/core/driver/reference/connecting/">Connecting</a> <i class="fa fa-angle-right"></i></li>
  <li>Connection Settings</li>
</ul>
</div>



<h1 id="connecting-to-mongodb">Connecting To MongoDB</h1>

<p>Connecting to MongoDB using the driver is done using the Topology classes <code>Server</code>, <code>ReplSet</code> and <code>Mongos</code>. There is no auto detection of the server topology as this is a low level driver.</p>

<h2 id="single-server-connection">Single Server Connection</h2>

<p>We have a single MongoDB server instance running on the port <em>27017</em> Let&rsquo;s connect using the driver and <em>MongoClient.connect</em></p>

<pre><code class="language-js">var Server = require('mongodb-core').Server
  , assert = require('assert');

var server = new Server({host: 'localhost', port: 27017});
// Wait for the connection event
server.on('connect', function(server) {
  server.destroy();
});

// Start connecting
server.connect();
</code></pre>

<p>Let&rsquo;s break down the connection options available.</p>

<ul>
<li><code>reconnect</code> <strong>{boolean, default:true}</strong> Server will attempt to reconnect on loss of connection</li>
<li><code>reconnectTries</code> <strong>{number, default:30}</strong> Server attempt to reconnect #times</li>
<li><code>reconnectInterval</code> <strong>{number, default:1000}</strong> Server will wait # milliseconds between retries</li>
<li><code>emitError</code> <strong>{boolean, default:false}</strong> Server will emit errors events</li>
<li><code>cursorFactory</code> <strong>{Cursor, default:Cursor}</strong> The cursor factory class used for all query cursors</li>
<li><code>host</code> <strong>{string}</strong> The server host</li>
<li><code>port</code> <strong>{number}</strong> The server port</li>
<li><code>size</code> <strong>{number, default:5}</strong> Server connection pool size</li>
<li><code>keepAlive</code> <strong>{boolean, default:true}</strong> TCP Connection keep alive enabled</li>
<li><code>keepAliveInitialDelay</code> <strong>{number, default:0}</strong> Initial delay before TCP keep alive enabled</li>
<li><code>noDelay</code> <strong>{boolean, default:true}</strong> TCP Connection no delay</li>
<li><code>connectionTimeout</code> <strong>{number, default:0}</strong> TCP Connection timeout setting</li>
<li><code>socketTimeout</code> <strong>{number, default:0}</strong> TCP Socket timeout setting</li>
<li><code>singleBufferSerializtion</code> <strong>{boolean, default:true}</strong> Serialize into single buffer, trade of peak memory for serialization speed</li>
<li><code>ssl</code> <strong>{boolean, default:false}</strong> Use SSL for connection</li>
<li><code>ca</code> <strong>{Buffer}</strong> SSL Certificate store binary buffer</li>
<li><code>cert</code> <strong>{Buffer}</strong> SSL Certificate binary buffer</li>
<li><code>key</code> <strong>{Buffer}</strong> SSL Key file binary buffer</li>
<li><code>passphrase</code> <strong>{string}</strong> SSL Certificate pass phrase</li>
<li><code>rejectUnauthorized</code> <strong>{boolean, default:true}</strong> Reject unauthorized server certificates</li>
<li><code>promoteLongs</code> <strong>{boolean, default:true}</strong> Convert Long values from the db into Numbers if they fit into 53 bits</li>
</ul>

<h2 id="replicaset-connection">Replicaset Connection</h2>

<p>We wish to connect to a ReplicaSet consisting of one primary and 1 or more secondaries. To Do this we need to supply the driver with a seedlist of servers and the name of the ReplicaSet we wish to connect to. Let&rsquo;s take a look at a code example.</p>

<pre><code class="language-js">var ReplSet = require('mongodb-core').ReplSet
  , assert = require('assert');

var server = new ReplSet(
    [{host: 'localhost', port: 31000}, {host: 'localhost', port: 31001}]
  , {setName: 'rs'});
// Wait for the connection event
server.on('connect', function(server) {
  server.destroy();
});

// Start connecting
server.connect();
</code></pre>

<p>Let&rsquo;s break down the connection options available.</p>

<ul>
<li><code>setName</code> <strong>{string}</strong> The Replicaset set name</li>
<li><code>secondaryOnlyConnectionAllowed</code> <strong>{boolean, default:false}</strong> Allow connection to a secondary only replicaset</li>
<li><code>haInterval</code> <strong>{number, default:5000}</strong> The High availability period for replicaset inquiry</li>
<li><code>emitError</code> <strong>{boolean, default:false}</strong> Server will emit errors events</li>
<li><code>cursorFactory</code> <strong>{Cursor, default:Cursor}</strong> The cursor factory class used for all query cursors</li>
<li><code>size</code> <strong>{number, default:5}</strong> Server connection pool size</li>
<li><code>keepAlive</code> <strong>{boolean, default:true}</strong> TCP Connection keep alive enabled</li>
<li><code>keepAliveInitialDelay</code> <strong>{number, default:0}</strong> Initial delay before TCP keep alive enabled</li>
<li><code>noDelay</code> <strong>{boolean, default:true}</strong> TCP Connection no delay</li>
<li><code>connectionTimeout</code> <strong>{number, default:0}</strong> TCP Connection timeout setting</li>
<li><code>socketTimeout</code> <strong>{number, default:0}</strong> TCP Socket timeout setting</li>
<li><code>singleBufferSerializtion</code> <strong>{boolean, default:true}</strong> Serialize into single buffer, trade of peak memory for serialization speed</li>
<li><code>ssl</code> <strong>{boolean, default:false}</strong> Use SSL for connection</li>
<li><code>ca</code> <strong>{Buffer}</strong> SSL Certificate store binary buffer</li>
<li><code>cert</code> <strong>{Buffer}</strong> SSL Certificate binary buffer</li>
<li><code>key</code> <strong>{Buffer}</strong> SSL Key file binary buffer</li>
<li><code>passphrase</code> <strong>{string}</strong> SSL Certificate pass phrase</li>
<li><code>rejectUnauthorized</code> <strong>{boolean, default:true}</strong> Reject unauthorized server certificates</li>
<li><code>promoteLongs</code> <strong>{boolean, default:true}</strong> Convert Long values from the db into Numbers if they fit into 53 bits</li>
</ul>

<h2 id="mongos-proxy-connection">Mongos Proxy Connection</h2>

<p>We wish to connect to a set of <code>mongos</code> proxies. Just as in the case of connecting to a ReplicaSet we can provide a seed list of <code>mongos</code> proxies. This allows the driver to perform failover between proxies automatically in case of a proxy process having been shut down. Let&rsquo;s look at an example of code connecting to a set of proxies.</p>

<pre><code class="language-js">var Mongos = require('mongodb-core').Mongos
  , assert = require('assert');

var server = new Mongos(
    [{host: 'localhost', port: 50000}, {host: 'localhost', port: 50001}]
  );
// Wait for the connection event
server.on('connect', function(server) {
  server.destroy();
});

// Start connecting
server.connect();
</code></pre>

<p>Let&rsquo;s break down the connection options available.</p>

<ul>
<li><code>reconnectTries</code> <strong>{number, default:30}</strong> Reconnect retries for HA if no servers available</li>
<li><code>haInterval</code> <strong>{number, default:5000}</strong> The High availability period for replicaset inquiry</li>
<li><code>emitError</code> <strong>{boolean, default:false}</strong> Server will emit errors events</li>
<li><code>cursorFactory</code> <strong>{Cursor, default:Cursor}</strong> The cursor factory class used for all query cursors</li>
<li><code>size</code> <strong>{number, default:5}</strong> Server connection pool size</li>
<li><code>keepAlive</code> <strong>{boolean, default:true}</strong> TCP Connection keep alive enabled</li>
<li><code>keepAliveInitialDelay</code> <strong>{number, default:0}</strong> Initial delay before TCP keep alive enabled</li>
<li><code>noDelay</code> <strong>{boolean, default:true}</strong> TCP Connection no delay</li>
<li><code>connectionTimeout</code> <strong>{number, default:0}</strong> TCP Connection timeout setting</li>
<li><code>socketTimeout</code> <strong>{number, default:0}</strong> TCP Socket timeout setting</li>
<li><code>singleBufferSerializtion</code> <strong>{boolean, default:true}</strong> Serialize into single buffer, trade of peak memory for serialization speed</li>
<li><code>ssl</code> <strong>{boolean, default:false}</strong> Use SSL for connection</li>
<li><code>ca</code> <strong>{Buffer}</strong> SSL Certificate store binary buffer</li>
<li><code>cert</code> <strong>{Buffer}</strong> SSL Certificate binary buffer</li>
<li><code>key</code> <strong>{Buffer}</strong> SSL Key file binary buffer</li>
<li><code>passphrase</code> <strong>{string}</strong> SSL Certificate pass phrase</li>
<li><code>rejectUnauthorized</code> <strong>{boolean, default:true}</strong> Reject unauthorized server certificates</li>
<li><code>promoteLongs</code> <strong>{boolean, default:true}</strong> Convert Long values from the db into Numbers if they fit into 53 bits</li>
</ul>

<h2 id="authentication-using-the-core-driver">Authentication using the Core Driver</h2>

<p>Authentication is fairly easy to perform and is done using the <code>auth</code> method on the connected topology instance. Let&rsquo;s look at a simple example of authenticating using the <code>MongoCR</code> authentication strategy.</p>

<pre><code class="language-js">var Server = require('mongodb-core').Server
  , assert = require('assert');

var server = new Server({host: 'localhost', port: 27017});
// Wait for the connection event
server.on('connect', function(server) {
  server.auth('mongocr', 'admin', 'test', 'test', function(err, session) {    
    server.destroy();
  });
});

// Start connecting
server.connect();
</code></pre>

<p>The first argument is the authentication mechanism you wish to use, the second argument is the database you wish to authenticate against and the rest of the parameters are authentication mechanism specific with the last parameter being the callback function. The authentication is performed against all connections on the topology. The driver currently provides the following authentication mechanisms.</p>

<ul>
<li><code>mongocr</code> The current default MongoDB authentication mechanism.</li>
<li><code>x509</code> Using a X509 Certificate for the authentication.</li>
<li><code>plain</code> Use LDAP for authentication using $external.</li>
<li><code>gssapi</code> Linux Kerberos authentication using MIT library.</li>
<li><code>sspi</code> Windows Kerberos authentication using SSPI.</li>
<li><code>scram-sha-1</code> 2.8 or higher default authentication mechanism.</li>
</ul>






<div id="btnv">
  
  <div class="pull-left">
  <a class="navigation prev" href="/node-mongodb-native/core/driver/getting-started/">
      <i class="fa fa-long-arrow-left"> </i> Getting Started
  </a>
  </div>
  
  
  <div class="pull-right">
  <a class="navigation next" href="/node-mongodb-native/core/driver/reference/crud/">
    CRUD Operations <i class="fa fa-long-arrow-right"> </i>
  </a>
  
</div>
</div>


</div>
<div class="right-column">
<div class="wrapper">
  
  <div class="toc">
    <span class="toc-header">On this page</span>
    <nav id="TableOfContents">
<ul>
<li><a href="#connecting-to-mongodb">Connecting To MongoDB</a>
<ul>
<li><a href="#single-server-connection">Single Server Connection</a></li>
<li><a href="#replicaset-connection">Replicaset Connection</a></li>
<li><a href="#mongos-proxy-connection">Mongos Proxy Connection</a></li>
<li><a href="#authentication-using-the-core-driver">Authentication using the Core Driver</a></li>
</ul></li>
</ul>
</nav>
  </div>
  
</div>
</div>

</div>
</div>
</div>
</section>
</section>

</section>


<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
   URL_ROOT:    "/node-mongodb-native/core",
   VERSION:     "3.0.0-rc0",
   COLLAPSE_INDEX: false,
   FILE_SUFFIX: '.html',
   HAS_SOURCE:  true
  };
</script>
<script type="text/javascript" src="/node-mongodb-native/core/js/jquery.js"></script>
<script type="text/javascript" src="/node-mongodb-native/core/lib/bootstrap.js"></script>
<script type="text/javascript" src="/node-mongodb-native/core/js/navbar.js"></script>
<script type="text/javascript" src="/node-mongodb-native/core/lib/highlight/highlight.pack.js"></script>
<script type="text/javascript" src="/node-mongodb-native/core/js/scripts.js"></script>
<script type="text/javascript" src="/node-mongodb-native/core/lib/bootstrap-toggle/bootstrap-toggle.min.js"></script>
<script type="text/javascript" src="/node-mongodb-native/core/js/java.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-29229787-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
